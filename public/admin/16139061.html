
<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="referrer" content="origin" />
</head>
<body class="has-navbar">
    <div id="app"><p>/// &lt;summary&gt;<br>        /// 得到物理网卡的地址<br>        /// &lt;/summary&gt;<br>        /// &lt;returns&gt;&lt;/returns&gt;<br>        private static string GetNetAdapterInfo()<br>        {<br>            NetworkInterface[] adapters = NetworkInterface.GetAllNetworkInterfaces();<br>            bool isExistPhysicsMac = false;<br>            string macID = "";<br>            if (adapters != null)<br>            {<br>                foreach (NetworkInterface ni in adapters)<br>                {<br>                    string fCardType = "未知网卡";<br>                    IPInterfaceProperties ips = ni.GetIPProperties();<br><br>                    PhysicalAddress pa = ni.GetPhysicalAddress();<br>                    if (pa == null) continue;<br>                    string pastr = pa.ToString();<br>                    if (pastr.Length &lt; 7) continue;<br>                    if (pastr.Substring(0, 6) == "000000") continue;<br>                    if (ni.Name.ToLower().IndexOf("vmware") &gt; -1) continue;<br>                    string fRegistryKey = "SYSTEM\\CurrentControlSet\\Control\\Network\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\" + ni.Id + "\\Connection";<br>                    RegistryKey rk = Registry.LocalMachine.OpenSubKey(fRegistryKey, false);<br>                    if (rk != null)<br>                    {<br>                        // 区分 PnpInstanceID       <br>                        // 如果前面有 PCI 就是本机的真实网卡      <br>                        // MediaSubType 为 01 则是常见网卡，02为无线网卡。      <br>                        string fPnpInstanceID = rk.GetValue("PnpInstanceID", "").ToString();<br>                        //int fMediaSubType = Convert.ToInt32(rk.GetValue("MediaSubType", 0));<br>                        if (fPnpInstanceID.Length &gt; 3 &amp;&amp; fPnpInstanceID.Substring(0, 3) == "PCI")<br>                        {<br>                            if (ni.NetworkInterfaceType.ToString().ToLower().IndexOf("wireless") == -1)<br>                            {<br>                                isExistPhysicsMac = true;<br>                                fCardType = "物理网卡";<br>                                return ni.GetPhysicalAddress().ToString();<br>                            }<br>                            //else<br>                            //{<br>                            //    fCardType = "无线网卡";<br>		     //    return ni.GetPhysicalAddress().ToString();<br>                            //}<br>                        }<br><br>                        //else if (fMediaSubType == 1 || fMediaSubType == 0)<br>                        //    fCardType = "虚拟网卡";<br>                        //else if (fMediaSubType == 2 || ni.NetworkInterfaceType.ToString().ToLower().IndexOf("wireless") &gt; -1)<br>                        //    fCardType = "无线网卡";<br>                        //else if (fMediaSubType == 7)<br>                        //    fCardType = "蓝牙";<br>                    }<br>                }<br>            }<br>            return "";<br>        }<img src="\admin\img\bb.jpg" data-href="admin%5Cimg%5Cbb.jpg" style="max-width: 100%;"><br></p>    </div>
</body>
</html>